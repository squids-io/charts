apiVersion: v1
data:
  mariadb-10.1.14: |2

    # mariadb 10.1.14
    [client]
    loose_default-character-set = {{.DefaultCharacterSet}}
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    user=admin

    [mysqldump]
    quick
    max_allowed_packet = 2G
    default-character-set = {{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\\u@\\h : \\d \\R:\\m:\\s> "
    default-character-set = {{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    large-pages
    #***********************************common parameters******************************
    #memlock
    default-storage-engine = INNODB
    character-set-server = {{.DefaultCharacterSet}}
    collation_server = {{.DefaultCharacterSet}}_bin

    user=mysql
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    pid-file=/var/lib/mysql/data/sock/mysql.pid
    datadir=/var/lib/mysql/data/mydata
    tmpdir=/var/lib/mysql/data/tmpdir

    skip-name-resolve
    skip_external_locking

    lower_case_table_names=1
    event_scheduler=0
    back_log=512
    default-time-zone={{.Timezone}}

    max_connections = {{.MaxConnections}}
    max_connect_errors=99999
    max_allowed_packet = 64M
    slave_pending_jobs_size_max=128M
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k

    wait_timeout=172800
    interactive_timeout=172800

    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M

    table_open_cache = 4096
    table_open_cache_instances = 2
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M

    query_cache_size=0
    query_cache_type=OFF
    explicit_defaults_for_timestamp=ON

    #*******************************  Logs related settings ***************************
    log-error=/var/log/mysql/error.log
    long_query_time = 1
    slow_query_log = 1
    slow_query_log_file=/var/log/mysql/slow-query.log
    log_slow_slave_statements
    #log_queries_not_using_indexes

    #*******************************  Replication related settings **********************

    #### For Master
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    binlog-rows-query-log-events=1
    max_binlog_size=512M
    expire_logs_days=15
    sync_binlog=1
    master-verify-checksum=1
    master-info-repository=TABLE
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    relay-log-info-repository=TABLE
    relay-log-recovery=1
    #slave-skip-errors=1022,1032,1062,1236
    slave-sql-verify-checksum=1
    log_bin_trust_function_creators=1
    log_slave_updates=1
    slave-net-timeout=10

    #******************************* MyISAM Specific options ****************************
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    # ***************************** INNODB Specific options ****************************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:1G:autoextend
    innodb_file_per_table
    innodb_file_format = barracuda
    innodb_file_format_max = barracuda
    innodb_file_format_check = ON
    innodb_strict_mode = 1
    innodb_flush_method = fsync
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2

    #### Buffer Pool options
    innodb_buffer_pool_size = 6G
    innodb_buffer_pool_instances = 2
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_flush_neighbors = 0
    innodb_lru_scan_depth = 4096
    #innodb_change_buffering = inserts
    innodb_old_blocks_time = 1000
    innodb_doublewrite = OFF

    #### Redo options
    innodb_log_group_home_dir = /var/lib/mysql/data/redo
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 2
    innodb_support_xa = ON

    #### Transaction options
    innodb_thread_concurrency = 64
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_io_capacity = 20000
    innodb_use_native_aio = 1

    #### Undo options
    #innodb_undo_directory = /var/lib/mysql/
    #innodb_undo_tablespaces=8
    #innodb_purge_threads = 4
    #innodb_purge_batch_size = 512
    #innodb_max_purge_lag = 65536

    #### 5.6/5.7 GTID
    #gtid-mode=on # GTID only
    #enforce-gtid-consistency=true # GTID only

    #### mysql 5.7
    #super_read_only=on
    #secure_file_priv=/var/lib/mysql
    #slave_parallel_workers=16
    #slave_parallel_type=LOGICAL_CLOCK
    #innodb_undo_log_truncate=ON
    #log_timestamps=SYSTEM
    #slave_preserve_commit_order=ON

    #### mariadb
    gtid_strict_mode=on
    gtid_domain_id=125
    slave_parallel_threads=16

    #### Slave
    read_only={{.ReadOnly}}

    # include extra parameter like mysql server id
    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
    !include /etc/mysql.cnf.d/mysql-expand.conf
  mariadb-10.2.10: |2

    # mariadb 10.2.10
    [client]
    loose_default-character-set = {{.DefaultCharacterSet}}
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    user=admin

    [mysqldump]
    quick
    max_allowed_packet = 2G
    default-character-set = {{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\\u@\\h : \\d \\R:\\m:\\s> "
    default-character-set = {{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    large-pages
    #***********************************common parameters******************************
    #memlock
    default-storage-engine = INNODB
    character-set-server={{.DefaultCharacterSet}}
    collation_server = {{.DefaultCharacterSet}}_bin

    user=mysql
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    pid-file=/var/lib/mysql/data/sock/mysql.pid
    datadir=/var/lib/mysql/data/mydata
    tmpdir=/var/lib/mysql/data/tmpdir

    skip-name-resolve
    skip_external_locking

    lower_case_table_names=1
    event_scheduler=0
    back_log=512
    default-time-zone={{.Timezone}}

    max_connections = {{.MaxConnections}}
    max_connect_errors=99999
    max_allowed_packet = 64M
    slave_pending_jobs_size_max=128M
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k

    wait_timeout=172800
    interactive_timeout=172800

    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M

    table_open_cache = 4096
    table_open_cache_instances = 2
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M

    query_cache_size=0
    query_cache_type=OFF
    explicit_defaults_for_timestamp=ON

    #*******************************  Logs related settings ***************************
    log-error=/var/log/mysql/error.log
    long_query_time = 1
    slow_query_log = 1
    slow_query_log_file=/var/log/mysql/slow-query.log
    log_slow_slave_statements
    #log_queries_not_using_indexes

    #*******************************  Replication related settings **********************

    #### For Master
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    binlog-rows-query-log-events=1
    max_binlog_size=512M
    expire_logs_days=15
    sync_binlog=1
    master-verify-checksum=1
    master-info-repository=TABLE
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    relay-log-info-repository=TABLE
    relay-log-recovery=1
    #slave-skip-errors=1022,1032,1062,1236
    slave-sql-verify-checksum=1
    log_bin_trust_function_creators=1
    log_slave_updates=1
    slave-net-timeout=10

    #******************************* MyISAM Specific options ****************************
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    # ***************************** INNODB Specific options ****************************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:1G:autoextend
    innodb_file_per_table
    innodb_file_format = barracuda
    innodb_file_format_max = barracuda
    innodb_file_format_check = ON
    innodb_strict_mode = 1
    innodb_flush_method = fsync
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2

    #### Buffer Pool options
    innodb_buffer_pool_size = 6G
    innodb_buffer_pool_instances = 2
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_flush_neighbors = 0
    innodb_lru_scan_depth = 4096
    #innodb_change_buffering = inserts
    innodb_old_blocks_time = 1000
    innodb_doublewrite = OFF

    #### Redo options
    innodb_log_group_home_dir = /var/lib/mysql/data/redo
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 2
    innodb_support_xa = ON

    #### Transaction options
    innodb_thread_concurrency = 64
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_io_capacity = 20000
    innodb_use_native_aio = 1

    #### Undo options
    #innodb_undo_directory = /var/lib/mysql/
    #innodb_undo_tablespaces=8
    #innodb_purge_threads = 4
    #innodb_purge_batch_size = 512
    #innodb_max_purge_lag = 65536

    #### 5.6/5.7 GTID
    #gtid-mode=on # GTID only
    #enforce-gtid-consistency=true # GTID only

    #### mysql 5.7
    #super_read_only=on
    #secure_file_priv=/var/lib/mysql
    #slave_parallel_workers=16
    #slave_parallel_type=LOGICAL_CLOCK
    #innodb_undo_log_truncate=ON
    #log_timestamps=SYSTEM
    #slave_preserve_commit_order=ON

    #### mariadb
    gtid_strict_mode=on
    gtid_domain_id=125
    slave_parallel_threads=16

    #### Slave
    read_only={{.ReadOnly}}

    # include extra parameter like mysql server id
    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
    !include /etc/mysql.cnf.d/mysql-expand.conf
  mariadb-10.3: |2

    loose_default-character-set={{.DefaultCharacterSet}}
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    user=mysql

    [mysqldump]
    quick
    max_allowed_packet = 2G
    default-character-set={{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\u@\h:\p \R:\m:\s [\d]> "
    default-character-set={{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    datadir=/var/lib/mysql/data/mydata
    socket=/var/lib/mysql/data/sock/mysql.sock
    port=3306
    symbolic-links=0
    pid-file=/var/lib/mysql/data/sock/mysqld.pid
    loose-plugin-load=""
    innodb_flush_method =O_DIRECT
    innodb_doublewrite = ON
    innodb_adaptive_hash_index=on
    innodb_adaptive_hash_index_parts=4
    character-set-server=utf8
    collation_server=utf8_bin
    default_storage_engine=INNODB
    performance_schema=off
    user=mysql
    tmpdir=/var/lib/mysql/data/tmpdir

    skip-name-resolve
    skip_external_locking

    lower_case_table_names=1
    event_scheduler=0
    back_log=3000
    default-time-zone={{.Timezone}}

    aria_max_sort_file_size=2097152
    aria_pagecache_buffer_size=16777216
    aria_sort_buffer_size=2097152
    binlog_row_image=full
    binlog_stmt_cache_size=32768
    concurrent_insert=1
    connect_timeout=10

    default_week_format=0
    delayed_insert_limit=100
    delayed_insert_timeout=300
    delayed_queue_size=1000
    delay_key_write=ON
    group_concat_max_len=1024
    innodb_concurrency_tickets=5000
    innodb_spin_wait_delay=6
    innodb_stats_sample_pages=16
    max_write_lock_count=102400
    read_buffer_size=1M
    read_rnd_buffer_size=262144
    slave_net_timeout=60

    max_connect_errors=99999
    max_allowed_packet = 64M
    max_heap_table_size = 16M
    max_length_for_sort_data = 16k

    wait_timeout=172800
    interactive_timeout=172800

    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 2M
    binlog_cache_size = 2M

    table_open_cache = 4096
    table_definition_cache = 4096
    thread_cache_size = 256
    tmp_table_size = 8M

    query_cache_size=0
    query_cache_type=OFF
    explicit_defaults_for_timestamp=ON
    metadata_locks_hash_instances=32

    #*******************************  Logs related settings ***************************
    log-error=/var/log/mysql/error.log
    long_query_time = 1
    slow_query_log = 1
    slow_query_log_file=/var/log/mysql/slow-query.log
    log_slow_slave_statements=ON
    log_queries_not_using_indexes=OFF

    #*******************************  Replication related settings **********************
    #### For Master
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    max_binlog_size = 512M
    expire_logs_days=7
    sync_binlog=1
    master-verify-checksum=1
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    relay-log-recovery=1
    #slave-skip-errors=1022,1032,1062,1236
    slave-sql-verify-checksum=1
    log_bin_trust_function_creators=1
    log_slave_updates=1
    slave-net-timeout=10
    gtid_strict_mode=on
    slave_parallel_mode=conservative
    slave_parallel_threads=16

    #******************************* MyISAM Specific options ****************************
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 16M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    #***************************** INNODB Specific options ****************************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:128M:autoextend
    innodb_file_per_table
    innodb_file_format = barracuda
    innodb_strict_mode = 1
    innodb_flush_method = O_DIRECT
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=1

    #### Buffer Pool options
    innodb_buffer_pool_size={{.InnodbBufferPoolSize}}
    innodb_buffer_pool_instances ={{.InnodbBufferPoolInstances}}
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_flush_neighbors = 0
    innodb_lru_scan_depth = 4096
    #innodb_change_buffering = inserts
    innodb_old_blocks_time = 1000
    innodb_doublewrite = ON

    #### Redo options
    innodb_log_group_home_dir =/var/lib/mysql/data/redo
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 1

    #### Transaction options
    innodb_thread_concurrency = 0
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_read_io_threads = 8
    innodb_write_io_threads = 12
    innodb_io_capacity = 20000
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/data/undo/
    innodb_undo_tablespaces=8
    innodb_purge_threads = 2
    innodb_undo_log_truncate=ON
    innodb_purge_batch_size = 300
    innodb_max_purge_lag = 65536

    #### extra connection
    extra_max_connections=10
    extra_port=3309

    #### Slave
    read_only={{.ReadOnly}}

    max_connections = {{.MaxConnections}}
    relay_log_recovery=1
    expire_logs_days=8

    thread_cache_size=256
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M
    gtid_strict_mode=on
    gtid_ignore_duplicates=on
  mariadb-10.3-audit: |2

    loose_default-character-set={{.DefaultCharacterSet}}
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    user=mysql

    [mysqldump]
    quick
    max_allowed_packet = 2G
    default-character-set={{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\u@\h:\p \R:\m:\s [\d]> "
    default-character-set={{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    datadir=/var/lib/mysql/data/mydata
    socket=/var/lib/mysql/data/sock/mysql.sock
    port=3306
    symbolic-links=0
    pid-file=/var/lib/mysql/data/sock/mysqld.pid
    loose-plugin-load=""
    innodb_flush_method =O_DIRECT
    innodb_doublewrite = ON
    innodb_adaptive_hash_index=on
    innodb_adaptive_hash_index_parts=4
    character-set-server=utf8
    collation_server=utf8_bin
    default_storage_engine=INNODB
    performance_schema=off
    user=mysql
    tmpdir=/var/lib/mysql/data/tmpdir

    skip-name-resolve
    skip_external_locking

    lower_case_table_names=1
    event_scheduler=0
    back_log=3000
    default-time-zone={{.Timezone}}

    aria_max_sort_file_size=2097152
    aria_pagecache_buffer_size=16777216
    aria_sort_buffer_size=2097152
    binlog_row_image=full
    binlog_stmt_cache_size=32768
    concurrent_insert=1
    connect_timeout=10

    default_week_format=0
    delayed_insert_limit=100
    delayed_insert_timeout=300
    delayed_queue_size=1000
    delay_key_write=ON
    group_concat_max_len=1024
    innodb_concurrency_tickets=5000
    innodb_spin_wait_delay=6
    innodb_stats_sample_pages=16
    max_write_lock_count=102400
    read_buffer_size=1M
    read_rnd_buffer_size=262144
    slave_net_timeout=60

    max_connect_errors=99999
    max_allowed_packet = 64M
    max_heap_table_size = 16M
    max_length_for_sort_data = 16k

    wait_timeout=172800
    interactive_timeout=172800

    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 2M
    binlog_cache_size = 2M

    table_open_cache = 4096
    table_definition_cache = 4096
    thread_cache_size = 256
    tmp_table_size = 8M

    query_cache_size=0
    query_cache_type=OFF
    explicit_defaults_for_timestamp=ON
    metadata_locks_hash_instances=32

    #*******************************  Logs related settings ***************************
    log-error=/var/log/mysql/error.log
    long_query_time = 1
    slow_query_log = 1
    slow_query_log_file=/var/log/mysql/slow-query.log
    log_slow_slave_statements=ON
    log_queries_not_using_indexes=OFF

    #*******************************  Replication related settings **********************
    #### For Master
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    max_binlog_size = 512M
    expire_logs_days=7
    sync_binlog=1
    master-verify-checksum=1
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    relay-log-recovery=1
    #slave-skip-errors=1022,1032,1062,1236
    slave-sql-verify-checksum=1
    log_bin_trust_function_creators=1
    log_slave_updates=1
    slave-net-timeout=10
    gtid_strict_mode=on
    slave_parallel_mode=conservative
    slave_parallel_threads=16

    #******************************* MyISAM Specific options ****************************
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 16M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    #***************************** INNODB Specific options ****************************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:128M:autoextend
    innodb_file_per_table
    innodb_file_format = barracuda
    innodb_strict_mode = 1
    innodb_flush_method = O_DIRECT
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=1

    #### Buffer Pool options
    innodb_buffer_pool_size={{.InnodbBufferPoolSize}}
    innodb_buffer_pool_instances ={{.InnodbBufferPoolInstances}}
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_flush_neighbors = 0
    innodb_lru_scan_depth = 4096
    #innodb_change_buffering = inserts
    innodb_old_blocks_time = 1000
    innodb_doublewrite = ON

    #### Redo options
    innodb_log_group_home_dir =/var/lib/mysql/data/redo
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 1

    #### Transaction options
    innodb_thread_concurrency = 0
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_read_io_threads = 8
    innodb_write_io_threads = 12
    innodb_io_capacity = 20000
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/data/undo/
    innodb_undo_tablespaces=8
    innodb_purge_threads = 2
    innodb_undo_log_truncate=ON
    innodb_purge_batch_size = 300
    innodb_max_purge_lag = 65536

    #### extra connection
    extra_max_connections=10
    extra_port=3309

    #### Slave
    read_only={{.ReadOnly}}

    max_connections = {{.MaxConnections}}
    relay_log_recovery=1
    expire_logs_days=8

    thread_cache_size=256
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M
    gtid_strict_mode=on
    gtid_ignore_duplicates=on
  mariadb-10.3-audit-rw: |2+


    [mysqld]
    innodb_adaptive_hash_index_parts=32

    #### Slave
    {{if eq .Role "Slave"}}slave_parallel_threads={{.SlaveParallelWorkers}}{{end}}

    !include  /etc/mysql/my.ro.cnf
    !includedir /etc/mysql.cnf.d
    !include  /etc/mysql/ext.semi.cnf

  mariadb-10.5: |2+

    # mariadb 10.5

    [client]
    loose_default-character-set={{.DefaultCharacterSet}}
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    user=admin

    [mysqldump]
    quick
    max_allowed_packet = 2G
    default-character-set={{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\u@\h:\p \R:\m:\s [\d]> "
    default-character-set={{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    #***********************************common parameters******************************
    default-storage-engine = INNODB
    character-set-server={{.DefaultCharacterSet}}
    collation_server={{.DefaultCharacterSet}}_bin

    performance_schema=on

    user=mysql
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    pid-file=/var/lib/mysql/data/sock/mysql.pid
    datadir=/var/lib/mysql/data/mydata
    tmpdir=/var/lib/mysql/data/tmpdir

    skip-name-resolve
    skip_external_locking

    lower_case_table_names=1
    event_scheduler=0
    back_log=512
    default-time-zone={{.Timezone}}

    max_connections = 3000
    max_connect_errors=99999
    max_allowed_packet = 64M
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k

    wait_timeout=172800
    interactive_timeout=172800

    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M

    table_open_cache = 4096
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M

    query_cache_size=0
    query_cache_type=OFF
    explicit_defaults_for_timestamp=ON
    metadata_locks_hash_instances=32

    #*******************************  Logs related settings ***************************
    log-error=/var/log/mysql/error.log
    long_query_time = 1
    slow_query_log = 1
    slow_query_log_file=/var/log/mysql/slow-query.log
    log_slow_slave_statements=ON
    log_queries_not_using_indexes=OFF

    #*******************************  Replication related settings **********************
    #### For Master
    server-id=2323307
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    max_binlog_size = 512M
    expire_logs_days=7
    sync_binlog=1
    master-verify-checksum=1
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    relay-log-recovery=1
    #slave-skip-errors=1022,1032,1062,1236
    slave-sql-verify-checksum=1
    log_bin_trust_function_creators=1
    log_slave_updates=1
    slave-net-timeout=10
    gtid_strict_mode=on
    gtid_domain_id=1
    slave_parallel_mode=conservative
    slave_parallel_threads=16

    #******************************* MyISAM Specific options ****************************
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    #***************************** INNODB Specific options ****************************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:128M:autoextend
    innodb_file_per_table
    innodb_strict_mode = 1
    innodb_flush_method = O_DIRECT
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2

    #### Buffer Pool options
    innodb_buffer_pool_size=3160M
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_flush_neighbors = 0
    innodb_lru_scan_depth = 4096
    #innodb_change_buffering = inserts
    innodb_old_blocks_time = 1000
    innodb_doublewrite = ON

    #### Redo options
    innodb_log_group_home_dir =/var/lib/mysql/data/redo
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 4G
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 1

    #### Transaction options
    innodb_thread_concurrency = 0
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1innodb_undo_directory
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_io_capacity = 20000
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/data/undo
    innodb_undo_tablespaces=8
    innodb_purge_threads = 4
    innodb_undo_log_truncate=ON
    innodb_purge_batch_size = 512
    innodb_max_purge_lag = 65536

    #### extra connection
    extra_max_connections=10
    extra_port=3308


    max_connections = {{.MaxConnections}}
    read_only={{.ReadOnly}}
    relay_log_recovery={{.RelayLogRecovery}}
    expire_logs_days={{.ExpireLogsDays}}
    innodb_buffer_pool_size={{.InnodbBufferPoolSize}}

    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
    !include  /etc/mysql/ext.semi.cnf
    !include    /etc/mysql.cnf.d/mysql-expand.conf

  mariadb-10.5-audit: |2+

    # mariadb 10.5

    [client]
    loose_default-character-set={{.DefaultCharacterSet}}
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    user=admin

    [mysqldump]
    quick
    max_allowed_packet = 2G
    default-character-set={{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\u@\h:\p \R:\m:\s [\d]> "
    default-character-set={{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    #***********************************common parameters******************************
    default-storage-engine = INNODB
    character-set-server={{.DefaultCharacterSet}}
    collation_server={{.DefaultCharacterSet}}_bin

    performance_schema=on

    user=mysql
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    pid-file=/var/lib/mysql/data/sock/mysql.pid
    datadir=/var/lib/mysql/data/mydata
    tmpdir=/var/lib/mysql/data/tmpdir

    skip-name-resolve
    skip_external_locking

    lower_case_table_names=1
    event_scheduler=0
    back_log=512
    default-time-zone={{.Timezone}}

    max_connections = 3000
    max_connect_errors=99999
    max_allowed_packet = 64M
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k

    wait_timeout=172800
    interactive_timeout=172800

    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M

    table_open_cache = 4096
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M

    query_cache_size=0
    query_cache_type=OFF
    explicit_defaults_for_timestamp=ON
    metadata_locks_hash_instances=32

    #*******************************  Logs related settings ***************************
    log-error=/var/log/mysql/error.log
    long_query_time = 1
    slow_query_log = 1
    slow_query_log_file=/var/log/mysql/slow-query.log
    log_slow_slave_statements=ON
    log_queries_not_using_indexes=OFF

    #*******************************  Replication related settings **********************
    #### For Master
    server-id=2323307
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    max_binlog_size = 512M
    expire_logs_days=7
    sync_binlog=1
    master-verify-checksum=1
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    relay-log-recovery=1
    #slave-skip-errors=1022,1032,1062,1236
    slave-sql-verify-checksum=1
    log_bin_trust_function_creators=1
    log_slave_updates=1
    slave-net-timeout=10
    gtid_strict_mode=on
    gtid_domain_id=1
    slave_parallel_mode=conservative
    slave_parallel_threads=16

    #******************************* MyISAM Specific options ****************************
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    #***************************** INNODB Specific options ****************************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:128M:autoextend
    innodb_file_per_table
    innodb_strict_mode = 1
    innodb_flush_method = O_DIRECT
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2

    #### Buffer Pool options
    innodb_buffer_pool_size=3160M
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_flush_neighbors = 0
    innodb_lru_scan_depth = 4096
    #innodb_change_buffering = inserts
    innodb_old_blocks_time = 1000
    innodb_doublewrite = ON

    #### Redo options
    innodb_log_group_home_dir =/var/lib/mysql/data/redo
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 4G
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 1

    #### Transaction options
    innodb_thread_concurrency = 0
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1innodb_undo_directory
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_io_capacity = 20000
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/data/undo
    innodb_undo_tablespaces=8
    innodb_purge_threads = 4
    innodb_undo_log_truncate=ON
    innodb_purge_batch_size = 512
    innodb_max_purge_lag = 65536

    #### extra connection
    extra_max_connections=10
    extra_port=3308


    max_connections = {{.MaxConnections}}
    read_only={{.ReadOnly}}
    relay_log_recovery={{.RelayLogRecovery}}
    expire_logs_days={{.ExpireLogsDays}}
    innodb_buffer_pool_size={{.InnodbBufferPoolSize}}

    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
    !include  /etc/mysql/ext.semi.cnf
    !include    /etc/mysql.cnf.d/mysql-expand.conf

  mariadb-10.5-audit-rw: |2+


    [mysqld]
    innodb_adaptive_hash_index_parts=32

    #### Slave
    {{if eq .Role "Slave"}}slave_parallel_threads={{.SlaveParallelWorkers}}{{end}}

    !include  /etc/mysql/my.ro.cnf

  mariadb-10.5-rw: |2+


    [mysqld]
    innodb_adaptive_hash_index_parts=32

    #### Slave
    {{if eq .Role "Slave"}}slave_parallel_threads={{.SlaveParallelWorkers}}{{end}}

    !include  /etc/mysql/my.ro.cnf

  mgc-10.1: |2

    [client]
    loose_default-character-set = {{.DefaultCharacterSet}}
    port=3306
    socket=/var/lib/mysql/mysql.sock
    user=admin

    [mysqldump]
    quick
    max_allowed_packet = 2G
    default-character-set = {{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\u@\h : \d \R:\m:\s> "
    default-character-set = {{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    large-pages
    #***********************************common parameters******************************
    read_only=on
    #memlock
    default-storage-engine = INNODB
    character-set-server={{.DefaultCharacterSet}}
    collation_server = {{.DefaultCharacterSet}}_bin

    user=mysql
    port=3306
    socket=/var/lib/mysql/mysql.sock
    pid-file=/var/lib/mysql/mysql.pid
    datadir=/var/lib/mysql
    tmpdir=/var/lib/mysql

    skip-name-resolve
    skip_external_locking

    lower_case_table_names=1
    event_scheduler=0
    back_log=512
    default-time-zone={{.Timezone}}

    max_connections = {{.MaxConnections}}
    max_connect_errors=99999
    max_allowed_packet = 64M
    slave_pending_jobs_size_max=128M
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k

    wait_timeout=172800
    interactive_timeout=172800

    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M

    table_open_cache = 4096
    table_open_cache_instances = 2
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M

    query_cache_size=0
    query_cache_type=OFF
    explicit_defaults_for_timestamp=ON

    #*******************************  Logs related settings ***************************
    log-error=/var/log/mysql/error.log
    long_query_time = 1
    slow_query_log = 1
    slow_query_log_file=/var/log/mysql/slow-query.log
    log_slow_slave_statements
    #log_queries_not_using_indexes

    #*******************************  Replication related settings **********************

    #### For Master
    #server-id=3306112
    log-bin=/var/lib/mysql/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    binlog-rows-query-log-events=1
    max_binlog_size = 512M
    expire_logs_days=15
    sync_binlog=1
    master-verify-checksum=1
    master-info-repository=TABLE
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/mysql-relay-bin
    relay-log-info-repository=TABLE
    relay-log-recovery=1
    #slave-skip-errors=1022,1032,1062,1236
    slave-sql-verify-checksum=1
    log_bin_trust_function_creators=1
    log_slave_updates=1
    slave-net-timeout=10

    #******************************* MyISAM Specific options ****************************
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    # ***************************** INNODB Specific options ****************************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/
    innodb_data_file_path = ibdata1:256M:autoextend
    innodb_file_per_table
    innodb_file_format = barracuda
    innodb_file_format_max = barracuda
    innodb_file_format_check = ON
    innodb_strict_mode = 1
    innodb_flush_method = fsync
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2

    #### Buffer Pool options
    innodb_buffer_pool_size = 4G
    innodb_buffer_pool_instances = 2
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_flush_neighbors = 0
    innodb_lru_scan_depth = 4096
    #innodb_change_buffering = inserts
    innodb_old_blocks_time = 1000
    innodb_doublewrite = OFF

    #### Redo options
    innodb_log_group_home_dir =/var/lib/mysql/
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 2
    innodb_support_xa = ON

    #### Transaction options
    innodb_thread_concurrency = 64
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_io_capacity = 20000
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/
    innodb_undo_tablespaces=16
    innodb_purge_threads = 4
    innodb_purge_batch_size = 512
    innodb_max_purge_lag = 65536

    #### 5.6/5.7 GTID
    #gtid-mode=on # GTID only
    #enforce-gtid-consistency=true # GTID only

    #### mysql 5.7
    #super_read_only=on
    secure_file_priv=/var/lib/mysql
    #slave_parallel_workers=16
    #slave_parallel_type=LOGICAL_CLOCK
    #innodb_undo_log_truncate=ON
    #log_timestamps=SYSTEM
    #slave_preserve_commit_order=ON

    #### mariadb
    gtid_strict_mode=on
    gtid_domain_id=125
    slave_parallel_threads=16

    #### galera
    wsrep_on=on
    wsrep_provider=/usr/lib/galera/libgalera_smm.so
    wsrep_provider_options="gcache.size=4G"
    #
    wsrep_sst_method=xtrabackup-v2
    wsrep_sst_auth="xtrabackup:xtrabackuppass"
    wsrep_slave_threads=16
    # test123
    #innodb_support_xa = OFF
    #sync_binlog=0
    #innodb_flush_log_at_trx_commit = 0
    innodb_doublewrite=off
    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
  mysql-5.6: |2

    # mysql 5.6

    [client]
    socket=/var/lib/mysql/data/sock/mysql.sock

    [mysqldump]
    max_allowed_packet = 2G

    [mysqld]
    #large-pages
    #***********************************common parameters******************************
    #memlock
    default-storage-engine = INNODB
    character-set-server={{.DefaultCharacterSet}}
    collation_server = {{.DefaultCharacterSet}}_bin

    # ssl enable
    ssl-ca=/etc/pki/mysql/ca-cert.pem
    ssl-cert=/etc/pki/mysql/server-cert.pem
    ssl-key=/etc/pki/mysql/server-key.pem

    user=mysql
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    pid-file=/var/lib/mysql/data/sock/mysql.pid
    datadir=/var/lib/mysql/data/mydata
    tmpdir=/var/lib/mysql/data/tmpdir
    skip-name-resolve
    #skip_ssl
    lower_case_table_names=1
    default-time-zone={{.Timezone}}
    max_allowed_packet = 64M
    wait_timeout=172800
    interactive_timeout=172800
    query_cache_size=0
    query_cache_type=OFF

    #******************************* Logs related settings ***************************
    log-error=/var/log/mysql/error.log
    slow_query_log = 1
    slow_query_log_file=/var/log/mysql/slow-query.log

    #******************************* Replication related settings **********************

    #### For Master
    server-id=3306102
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    max_binlog_size = 512M
    sync_binlog=1
    master-verify-checksum=1
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    #slave-skip-errors=1022,1032,1062,1236
    slave-sql-verify-checksum=1
    log_slave_updates=1
    slave-net-timeout=10

    # ***************************** INNODB Specific options ****************************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:128M:autoextend
    innodb_file_per_table
    innodb_file_format = barracuda
    innodb_file_format_max = barracuda
    innodb_file_format_check = ON
    innodb_strict_mode = 1
    innodb_flush_method = O_DIRECT
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2

    #### Buffer Pool options
    innodb_buffer_pool_size={{.InnodbBufferPoolSize}}
    innodb_buffer_pool_instances={{.InnodbBufferPoolInstances}}
    innodb_flush_neighbors = 0
    #innodb_change_buffering = inserts
    innodb_doublewrite = ON

    #### Redo options
    innodb_log_group_home_dir = /var/lib/mysql/data/redo
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 1
    innodb_support_xa = ON

    #### Transaction options
    innodb_thread_concurrency = 64
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1

    #### IO options
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/data/undo/
    innodb_undo_tablespaces=16
    innodb_purge_threads = 4

    #### mysql >=5.6 mariadb warning
    master-info-repository=TABLE
    relay-log-info-repository=TABLE
    binlog-rows-query-log-events=1
    relay_log_recovery=1

    #### mysql >=5.6 mariadb error
    gtid-mode=on # GTID only
    enforce-gtid-consistency=true # GTID only

    read_only={{.ReadOnly}}
    expire_logs_days={{.ExpireLogsDays}}

    #### Slave
    {{if eq .Role "Slave"}}slave-parallel-workers={{.SlaveParallelWorkers}}{{end}}


    !include  /etc/mysql/ext.semi.cnf
    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
    !include /etc/mysql.cnf.d/mysql-expand.conf
  mysql-5.6-audit: |2

    # mysql 5.6

    [client]
    socket=/var/lib/mysql/data/sock/mysql.sock

    [mysqldump]
    max_allowed_packet = 2G

    [mysqld]
    #large-pages
    #***********************************common parameters******************************
    #memlock
    default-storage-engine = INNODB
    character-set-server={{.DefaultCharacterSet}}
    collation_server = {{.DefaultCharacterSet}}_bin

    # ssl enable
    ssl-ca=/etc/pki/mysql/ca-cert.pem
    ssl-cert=/etc/pki/mysql/server-cert.pem
    ssl-key=/etc/pki/mysql/server-key.pem

    user=mysql
    port=3306
    socket=/var/lib/mysql/data/sock/mysql.sock
    pid-file=/var/lib/mysql/data/sock/mysql.pid
    datadir=/var/lib/mysql/data/mydata
    tmpdir=/var/lib/mysql/data/tmpdir
    skip-name-resolve
    #skip_ssl
    lower_case_table_names=1
    default-time-zone={{.Timezone}}
    max_allowed_packet = 64M
    wait_timeout=172800
    interactive_timeout=172800
    query_cache_size=0
    query_cache_type=OFF

    #******************************* Logs related settings ***************************
    log-error=/var/log/mysql/error.log
    slow_query_log = 1
    slow_query_log_file=/var/log/mysql/slow-query.log

    #******************************* Replication related settings **********************

    #### For Master
    server-id=3306102
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    max_binlog_size = 512M
    sync_binlog=1
    master-verify-checksum=1
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    #slave-skip-errors=1022,1032,1062,1236
    slave-sql-verify-checksum=1
    log_slave_updates=1
    slave-net-timeout=10

    # ***************************** INNODB Specific options ****************************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:128M:autoextend
    innodb_file_per_table
    innodb_file_format = barracuda
    innodb_file_format_max = barracuda
    innodb_file_format_check = ON
    innodb_strict_mode = 1
    innodb_flush_method = O_DIRECT
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2

    #### Buffer Pool options
    innodb_buffer_pool_size={{.InnodbBufferPoolSize}}
    innodb_buffer_pool_instances={{.InnodbBufferPoolInstances}}
    innodb_flush_neighbors = 0
    #innodb_change_buffering = inserts
    innodb_doublewrite = ON

    #### Redo options
    innodb_log_group_home_dir = /var/lib/mysql/data/redo
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 1
    innodb_support_xa = ON

    #### Transaction options
    innodb_thread_concurrency = 64
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1

    #### IO options
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/data/undo/
    innodb_undo_tablespaces=16
    innodb_purge_threads = 4

    #### mysql >=5.6 mariadb warning
    master-info-repository=TABLE
    relay-log-info-repository=TABLE
    binlog-rows-query-log-events=1
    relay_log_recovery=1

    #### mysql >=5.6 mariadb error
    gtid-mode=on # GTID only
    enforce-gtid-consistency=true # GTID only

    read_only={{.ReadOnly}}
    expire_logs_days={{.ExpireLogsDays}}

    #### Slave
    {{if eq .Role "Slave"}}slave-parallel-workers={{.SlaveParallelWorkers}}{{end}}


    !include  /etc/mysql/ext.semi.cnf
    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
    !include /etc/mysql.cnf.d/mysql-expand.conf
  mysql-5.6-audit-rw: |2

    # mysql 5.6
    [client]
    loose_default-character-set = {{.DefaultCharacterSet}}
    port=3306
    user=admin

    [mysqldump]
    quick
    default-character-set = {{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\\u@\\h : \\d \\R:\\m:\\s> "
    default-character-set = {{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    #******* common parameters *******
    skip_external_locking
    event_scheduler=0
    back_log=512
    max_connections = {{.MaxConnections}}
    max_connect_errors=99999
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k
    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M
    table_open_cache = 4096
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M
    explicit_defaults_for_timestamp=ON
    metadata_locks_hash_instances=32

    #******** Logs related settings ********
    long_query_time = 1
    log_slow_slave_statements

    #### For Slave
    #slave-skip-errors=1022,1032,1062,1236
    log_bin_trust_function_creators=1

    #******** MyISAM Specific options *********
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    #### Buffer Pool options
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_lru_scan_depth = 4096
    innodb_old_blocks_time = 1000

    #### Transaction options
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_io_capacity = 20000

    #### Undo options
    innodb_purge_batch_size = 512
    innodb_max_purge_lag = 65536

    #### mysql >=5.6 mariadb warning
    table_open_cache_instances = 2
    slave_pending_jobs_size_max=128M

    !include  /etc/mysql/my.ro.cnf
  mysql-5.6-rw: |2

    # mysql 5.6
    [client]
    loose_default-character-set = {{.DefaultCharacterSet}}
    port=3306
    user=admin

    [mysqldump]
    quick
    default-character-set = {{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\\u@\\h : \\d \\R:\\m:\\s> "
    default-character-set = {{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    #******* common parameters *******
    skip_external_locking
    event_scheduler=0
    back_log=512
    max_connections = {{.MaxConnections}}
    max_connect_errors=99999
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k
    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M
    table_open_cache = 4096
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M
    explicit_defaults_for_timestamp=ON
    metadata_locks_hash_instances=32

    #******** Logs related settings ********
    long_query_time = 1
    log_slow_slave_statements

    #### For Slave
    #slave-skip-errors=1022,1032,1062,1236
    log_bin_trust_function_creators=1

    #******** MyISAM Specific options *********
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    #### Buffer Pool options
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_lru_scan_depth = 4096
    innodb_old_blocks_time = 1000

    #### Transaction options
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_io_capacity = 20000

    #### Undo options
    innodb_purge_batch_size = 512
    innodb_max_purge_lag = 65536

    #### mysql >=5.6 mariadb warning
    table_open_cache_instances = 2
    slave_pending_jobs_size_max=128M

    !include  /etc/mysql/my.ro.cnf
  mysql-5.7: |2

    # mysql 5.7
    [client]
    socket=/var/lib/mysql/data/sock/mysql.sock

    [mysqldump]
    max_allowed_packet = 1G

    [mysqld]
    #******** common parameters ********
    lower_case_table_names=1
    old_passwords=0
    default_storage_engine=innodb
    default_tmp_storage_engine=innodb
    internal_tmp_disk_storage_engine=innodb
    disabled_storage_engines=''
    skip_networking=OFF
    performance_schema=ON
    pid-file=/var/lib/mysql/data/sock/mysql.pid
    datadir=/var/lib/mysql/data/mydata
    tmpdir=/var/lib/mysql/data/tmpdir
    max_allowed_packet = 1G
    socket=/var/lib/mysql/data/sock/mysql.sock
    character-set-server={{.DefaultCharacterSet}}
    collation_server = {{.DefaultCharacterSet}}_bin
    user=mysql
    port=3306
    skip-name-resolve
    skip-grant-tables=0
    skip-slave-start=0
    wait_timeout=172800
    interactive_timeout=172800
    query_cache_size=0
    query_cache_type=OFF
    slow_query_log = 1
    slave-sql-verify-checksum=1
    binlog_row_image=full
    default-time-zone={{.Timezone}}
    innodb_file_format_max = barracuda

    # ssl enable
    ssl-ca=/etc/pki/mysql/ca-cert.pem
    ssl-cert=/etc/pki/mysql/server-cert.pem
    ssl-key=/etc/pki/mysql/server-key.pem

    #********** Logs related settings ***********
    log-error=/var/log/mysql/error.log
    slow_query_log_file=/var/log/mysql/slow-query.log


    #******** Replication related settings *********
    #### For Master
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    max_binlog_size = 512M
    sync_binlog=1
    master-verify-checksum=1
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    relay_log_purge=1
    slave-sql-verify-checksum=1
    log_slave_updates=1
    slave-net-timeout=10

    #********* INNODB Specific options ************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:128M:autoextend
    innodb_file_format = barracuda
    innodb_force_recovery=0
    innodb_flush_method = fsync
    innodb_page_size=16K
    innodb_file_per_table
    innodb_file_format_check = ON
    innodb_strict_mode = 1
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2
    innodb_flush_neighbors = 0

    #### Redo options
    innodb_log_group_home_dir = /var/lib/mysql/data/redo
    innodb_support_xa = ON
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 2

    #### IO options
    innodb_read_only=OFF
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/data/undo/
    innodb_undo_tablespaces=16
    innodb_purge_threads = 4

    #### Transaction options
    innodb_thread_concurrency = 64
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1

    #### mysql >=5.6 mariadb warning
    master_info_repository=TABLE
    relay_log_info_repository=TABLE
    binlog-rows-query-log-events=1

    #### mysql >=5.6 mariadb error
    gtid_mode=on # GTID only
    enforce_gtid_consistency=true # GTID only

    #### mysql >=5.7 mariadb error
    slave_parallel_type=LOGICAL_CLOCK
    slave_parallel_workers=16
    slave_parallel_type=LOGICAL_CLOCK
    slave_preserve_commit_order=ON

    log_timestamps=SYSTEM

    #### mysql >=5.7 || mariadb >=10.2
    innodb_undo_log_truncate=ON
    read_only={{.ReadOnly}}
    super_read_only={{.SuperReadOnly}}
    relay_log_recovery={{.RelayLogRecovery}}
    expire_logs_days={{.ExpireLogsDays}}

    #### mysql >=5.7 || mariadb >=10.2
    secure_file_priv=null
    innodb_adaptive_hash_index_parts=32
    innodb_buffer_pool_size={{.InnodbBufferPoolSize}}
    innodb_buffer_pool_instances={{.InnodbBufferPoolInstances}}
    #### Slave
    {{if eq .Role "Slave"}}slave-parallel-workers={{.SlaveParallelWorkers}}{{end}}

    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
    !include  /etc/mysql/ext.semi.cnf
    !include /etc/mysql.cnf.d/mysql-expand.conf
  mysql-5.7-audit: |2

    # mysql 5.7
    [client]
    socket=/var/lib/mysql/data/sock/mysql.sock

    [mysqldump]
    max_allowed_packet = 1G

    [mysqld]
    #******** common parameters ********
    lower_case_table_names=1
    old_passwords=0
    default_storage_engine=innodb
    default_tmp_storage_engine=innodb
    internal_tmp_disk_storage_engine=innodb
    disabled_storage_engines=''
    skip_networking=OFF
    performance_schema=ON
    pid-file=/var/lib/mysql/data/sock/mysql.pid
    datadir=/var/lib/mysql/data/mydata
    tmpdir=/var/lib/mysql/data/tmpdir
    max_allowed_packet = 1G
    socket=/var/lib/mysql/data/sock/mysql.sock
    character-set-server={{.DefaultCharacterSet}}
    collation_server = {{.DefaultCharacterSet}}_bin
    user=mysql
    port=3306
    skip-name-resolve
    skip-grant-tables=0
    skip-slave-start=0
    wait_timeout=172800
    interactive_timeout=172800
    query_cache_size=0
    query_cache_type=OFF
    slow_query_log = 1
    slave-sql-verify-checksum=1
    binlog_row_image=full
    default-time-zone={{.Timezone}}
    innodb_file_format_max = barracuda

    # ssl enable
    ssl-ca=/etc/pki/mysql/ca-cert.pem
    ssl-cert=/etc/pki/mysql/server-cert.pem
    ssl-key=/etc/pki/mysql/server-key.pem

    #********** Logs related settings ***********
    log-error=/var/log/mysql/error.log
    slow_query_log_file=/var/log/mysql/slow-query.log


    #******** Replication related settings *********
    #### For Master
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    max_binlog_size = 512M
    sync_binlog=1
    master-verify-checksum=1
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    relay_log_purge=1
    slave-sql-verify-checksum=1
    log_slave_updates=1
    slave-net-timeout=10

    #********* INNODB Specific options ************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:128M:autoextend
    innodb_file_format = barracuda
    innodb_force_recovery=0
    innodb_flush_method = fsync
    innodb_page_size=16K
    innodb_file_per_table
    innodb_file_format_check = ON
    innodb_strict_mode = 1
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2
    innodb_flush_neighbors = 0

    #### Redo options
    innodb_log_group_home_dir = /var/lib/mysql/data/redo
    innodb_support_xa = ON
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 2

    #### IO options
    innodb_read_only=OFF
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/data/undo/
    innodb_undo_tablespaces=16
    innodb_purge_threads = 4

    #### Transaction options
    innodb_thread_concurrency = 64
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1

    #### mysql >=5.6 mariadb warning
    master_info_repository=TABLE
    relay_log_info_repository=TABLE
    binlog-rows-query-log-events=1

    #### mysql >=5.6 mariadb error
    gtid_mode=on # GTID only
    enforce_gtid_consistency=true # GTID only

    #### mysql >=5.7 mariadb error
    slave_parallel_type=LOGICAL_CLOCK
    slave_parallel_workers=16
    slave_parallel_type=LOGICAL_CLOCK
    slave_preserve_commit_order=ON

    log_timestamps=SYSTEM

    #### mysql >=5.7 || mariadb >=10.2
    innodb_undo_log_truncate=ON
    read_only={{.ReadOnly}}
    super_read_only={{.SuperReadOnly}}
    relay_log_recovery={{.RelayLogRecovery}}
    expire_logs_days={{.ExpireLogsDays}}

    #### mysql >=5.7 || mariadb >=10.2
    secure_file_priv=null
    innodb_adaptive_hash_index_parts=32
    innodb_buffer_pool_size={{.InnodbBufferPoolSize}}
    innodb_buffer_pool_instances={{.InnodbBufferPoolInstances}}
    #### Slave
    {{if eq .Role "Slave"}}slave-parallel-workers={{.SlaveParallelWorkers}}{{end}}

    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
    !include  /etc/mysql/ext.semi.cnf
    !include /etc/mysql.cnf.d/mysql-expand.conf
  mysql-5.7-audit-rw: |2

    # mysql 5.7
    [client]
    loose_default-character-set = {{.DefaultCharacterSet}}
    port=3306
    user=admin

    [mysqldump]
    quick
    default-character-set = {{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\\u@\\h : \\d \\R:\\m:\\s> "
    default-character-set = {{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    #******* common parameters *******
    skip_external_locking
    event_scheduler=0
    back_log=512
    max_connections = {{.MaxConnections}}
    max_connect_errors=99999
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k
    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M
    table_open_cache = 4096
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M
    explicit_defaults_for_timestamp=ON
    metadata_locks_hash_instances=32

    #******** Logs related settings ********
    long_query_time = 1
    log_slow_slave_statements

    #### For Slave
    #slave-skip-errors=1022,1032,1062,1236
    log_bin_trust_function_creators=1

    #******** MyISAM Specific options *********
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    #### Buffer Pool options
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_lru_scan_depth = 4096
    innodb_old_blocks_time = 1000
    innodb_doublewrite = OFF

    #### Transaction options
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_io_capacity = 20000

    #### Undo options
    innodb_purge_batch_size = 512
    innodb_max_purge_lag = 65536

    #### mysql >=5.6 mariadb warning
    table_open_cache_instances = 2
    slave_pending_jobs_size_max=128M

    !include  /etc/mysql/my.ro.cnf
  mysql-5.7-rw: |2

    # mysql 5.7
    [client]
    loose_default-character-set = {{.DefaultCharacterSet}}
    port=3306
    user=admin

    [mysqldump]
    quick
    default-character-set = {{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\\u@\\h : \\d \\R:\\m:\\s> "
    default-character-set = {{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    #******* common parameters *******
    skip_external_locking
    event_scheduler=0
    back_log=512
    max_connections = {{.MaxConnections}}
    max_connect_errors=99999
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k
    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M
    table_open_cache = 4096
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M
    explicit_defaults_for_timestamp=ON
    metadata_locks_hash_instances=32

    #******** Logs related settings ********
    long_query_time = 1
    log_slow_slave_statements

    #### For Slave
    #slave-skip-errors=1022,1032,1062,1236
    log_bin_trust_function_creators=1

    #******** MyISAM Specific options *********
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    #### Buffer Pool options
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_lru_scan_depth = 4096
    innodb_old_blocks_time = 1000
    innodb_doublewrite = OFF

    #### Transaction options
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_io_capacity = 20000

    #### Undo options
    innodb_purge_batch_size = 512
    innodb_max_purge_lag = 65536

    #### mysql >=5.6 mariadb warning
    table_open_cache_instances = 2
    slave_pending_jobs_size_max=128M

    !include  /etc/mysql/my.ro.cnf
  mysql-8.0: |2+

    # mysql 8.0

    [mysqld]
    #******* common parameters *******
    lower_case_table_names=1

    #### Buffer Pool options
    innodb_doublewrite = ON

    #### mysql >=5.7 || mariadb >=10.2
    secure_file_priv=null
    innodb_adaptive_hash_index_parts=32
    innodb_buffer_pool_size={{.InnodbBufferPoolSize}}
    innodb_buffer_pool_instances={{.InnodbBufferPoolInstances}}

    #### Slave
    {{if eq .Role "Slave"}}slave-parallel-workers={{.SlaveParallelWorkers}}{{end}}

    [client]
    socket=/var/lib/mysql/data/sock/mysql.sock

    [mysqldump]
    max_allowed_packet = 1G

    [mysqld]
    #******** common parameters ********
    default_storage_engine=innodb
    default_tmp_storage_engine=innodb
    disabled_storage_engines=''
    skip_networking=OFF
    performance_schema=ON
    pid-file=/var/lib/mysql/data/sock/mysql.pid
    datadir=/var/lib/mysql/data/mydata
    tmpdir=/var/lib/mysql/data/tmpdir
    max_allowed_packet = 1G
    socket=/var/lib/mysql/data/sock/mysql.sock
    character-set-server = {{.DefaultCharacterSet}}
    collation_server = {{.DefaultCharacterSet}}_bin
    user=mysql
    port=3306
    skip-name-resolve
    skip-grant-tables=0
    skip-slave-start=0
    wait_timeout=172800
    interactive_timeout=172800
    slow_query_log = 1
    slave-sql-verify-checksum=1
    binlog_row_image=full
    default-time-zone={{.Timezone}}

    # ssl enable
    ssl-ca=/etc/pki/mysql/ca-cert.pem
    ssl-cert=/etc/pki/mysql/server-cert.pem
    ssl-key=/etc/pki/mysql/server-key.pem

    #********** Logs related settings ***********
    log-error=/var/log/mysql/error.log
    slow_query_log_file=/var/log/mysql/slow-query.log

    #******** Replication related settings *********
    #### For Master
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    max_binlog_size = 512M
    sync_binlog=1
    master-verify-checksum=1
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    relay_log_purge=1
    slave-sql-verify-checksum=1
    log_slave_updates=1
    slave-net-timeout=10

    #********* INNODB Specific options ************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:128M:autoextend
    innodb_force_recovery=0
    innodb_flush_method = O_DIRECT
    innodb_page_size=16K
    innodb_file_per_table
    innodb_strict_mode = 1
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2
    innodb_flush_neighbors = 0

    #### Redo options
    innodb_log_group_home_dir = /var/lib/mysql/data/redo
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 1

    #### IO options
    innodb_read_only=OFF
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/data/undo/
    innodb_purge_threads = 4

    #### Transaction options
    innodb_thread_concurrency = 64
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1

    #### mysql >=5.6 mariadb warning
    master_info_repository=TABLE
    relay_log_info_repository=TABLE
    binlog-rows-query-log-events=1

    #### mysql >=5.6 mariadb error
    gtid_mode=on # GTID only
    enforce_gtid_consistency=true # GTID only

    #### mysql >=5.7 mariadb error
    slave_parallel_type=LOGICAL_CLOCK
    slave_parallel_workers=16
    slave_preserve_commit_order=ON
    log_timestamps=SYSTEM

    #### mysql >=5.7 || mariadb >=10.2
    innodb_undo_log_truncate=ON
    relay_log_recovery=1
    binlog_expire_logs_seconds={{.ExpireLogsDays}}

    #### mysql = 8.0
    default_authentication_plugin=mysql_native_password

    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
    !include  /etc/mysql/ext.semi.cnf
    !include /etc/mysql.cnf.d/mysql-expand.conf

  mysql-8.0-audit: |2+

    # mysql 8.0

    [mysqld]
    #******* common parameters *******
    lower_case_table_names=1

    #### Buffer Pool options
    innodb_doublewrite = ON

    #### mysql >=5.7 || mariadb >=10.2
    secure_file_priv=null
    innodb_adaptive_hash_index_parts=32
    innodb_buffer_pool_size={{.InnodbBufferPoolSize}}
    innodb_buffer_pool_instances={{.InnodbBufferPoolInstances}}

    #### Slave
    {{if eq .Role "Slave"}}slave-parallel-workers={{.SlaveParallelWorkers}}{{end}}

    [client]
    socket=/var/lib/mysql/data/sock/mysql.sock

    [mysqldump]
    max_allowed_packet = 1G

    [mysqld]
    #******** common parameters ********
    default_storage_engine=innodb
    default_tmp_storage_engine=innodb
    disabled_storage_engines=''
    skip_networking=OFF
    performance_schema=ON
    pid-file=/var/lib/mysql/data/sock/mysql.pid
    datadir=/var/lib/mysql/data/mydata
    tmpdir=/var/lib/mysql/data/tmpdir
    max_allowed_packet = 1G
    socket=/var/lib/mysql/data/sock/mysql.sock
    character-set-server = {{.DefaultCharacterSet}}
    collation_server = {{.DefaultCharacterSet}}_bin
    user=mysql
    port=3306
    skip-name-resolve
    skip-grant-tables=0
    skip-slave-start=0
    wait_timeout=172800
    interactive_timeout=172800
    slow_query_log = 1
    slave-sql-verify-checksum=1
    binlog_row_image=full
    default-time-zone={{.Timezone}}

    # ssl enable
    ssl-ca=/etc/pki/mysql/ca-cert.pem
    ssl-cert=/etc/pki/mysql/server-cert.pem
    ssl-key=/etc/pki/mysql/server-key.pem

    #********** Logs related settings ***********
    log-error=/var/log/mysql/error.log
    slow_query_log_file=/var/log/mysql/slow-query.log

    #******** Replication related settings *********
    #### For Master
    log-bin=/var/lib/mysql/archive/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    max_binlog_size = 512M
    sync_binlog=1
    master-verify-checksum=1
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/data/relaylog/mysql-relay-bin
    relay_log_purge=1
    slave-sql-verify-checksum=1
    log_slave_updates=1
    slave-net-timeout=10

    #********* INNODB Specific options ************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/data/innodb_ts
    innodb_data_file_path = ibdata1:128M:autoextend
    innodb_force_recovery=0
    innodb_flush_method = O_DIRECT
    innodb_page_size=16K
    innodb_file_per_table
    innodb_strict_mode = 1
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2
    innodb_flush_neighbors = 0

    #### Redo options
    innodb_log_group_home_dir = /var/lib/mysql/data/redo
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 1

    #### IO options
    innodb_read_only=OFF
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/data/undo/
    innodb_purge_threads = 4

    #### Transaction options
    innodb_thread_concurrency = 64
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1

    #### mysql >=5.6 mariadb warning
    master_info_repository=TABLE
    relay_log_info_repository=TABLE
    binlog-rows-query-log-events=1

    #### mysql >=5.6 mariadb error
    gtid_mode=on # GTID only
    enforce_gtid_consistency=true # GTID only

    #### mysql >=5.7 mariadb error
    slave_parallel_type=LOGICAL_CLOCK
    slave_parallel_workers=16
    slave_preserve_commit_order=ON
    log_timestamps=SYSTEM

    #### mysql >=5.7 || mariadb >=10.2
    innodb_undo_log_truncate=ON
    relay_log_recovery=1
    binlog_expire_logs_seconds={{.ExpireLogsDays}}

    #### mysql = 8.0
    default_authentication_plugin=mysql_native_password

    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
    !include  /etc/mysql/ext.semi.cnf
    !include /etc/mysql.cnf.d/mysql-expand.conf

  mysql-8.0-audit-rw: |2+

    # mysql 8.0

    [client]
    loose_default-character-set = {{.DefaultCharacterSet}}
    port=3306
    user=admin

    [mysqldump]
    quick
    default-character-set = {{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\\u@\\h : \\d \\R:\\m:\\s> "
    default-character-set = {{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    #******* common parameters *******
    skip_external_locking
    event_scheduler=0
    back_log=512
    max_connections = {{.MaxConnections}}
    max_connect_errors=99999
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k
    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M
    table_open_cache = 4096
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M
    explicit_defaults_for_timestamp=ON

    #******** Logs related settings ********
    long_query_time = 1
    log_slow_slave_statements

    #### For Slave
    #slave-skip-errors=1022,1032,1062,1236
    log_bin_trust_function_creators=1

    #******** MyISAM Specific options *********
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    #### Buffer Pool options
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_lru_scan_depth = 4096
    innodb_old_blocks_time = 1000

    #### Transaction options
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_io_capacity = 20000

    #### Undo options
    innodb_purge_batch_size = 512
    innodb_max_purge_lag = 65536

    #### mysql >=5.6 mariadb warning
    table_open_cache_instances = 2
    slave_pending_jobs_size_max=128M

    !include  /etc/mysql/my.ro.cnf

  mysql-8.0-rw: |2+

    # mysql 8.0

    [client]
    loose_default-character-set = {{.DefaultCharacterSet}}
    port=3306
    user=admin

    [mysqldump]
    quick
    default-character-set = {{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\\u@\\h : \\d \\R:\\m:\\s> "
    default-character-set = {{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    #******* common parameters *******
    skip_external_locking
    event_scheduler=0
    back_log=512
    max_connections = {{.MaxConnections}}
    max_connect_errors=99999
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k
    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M
    table_open_cache = 4096
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M
    explicit_defaults_for_timestamp=ON

    #******** Logs related settings ********
    long_query_time = 1
    log_slow_slave_statements

    #### For Slave
    #slave-skip-errors=1022,1032,1062,1236
    log_bin_trust_function_creators=1

    #******** MyISAM Specific options *********
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    #### Buffer Pool options
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_lru_scan_depth = 4096
    innodb_old_blocks_time = 1000

    #### Transaction options
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_io_capacity = 20000

    #### Undo options
    innodb_purge_batch_size = 512
    innodb_max_purge_lag = 65536

    #### mysql >=5.6 mariadb warning
    table_open_cache_instances = 2
    slave_pending_jobs_size_max=128M

    !include  /etc/mysql/my.ro.cnf

  pxc-5.7: |2

    [client]
    loose_default-character-set = {{.DefaultCharacterSet}}
    port=3306
    socket=/var/lib/mysql/mysql.sock
    user=admin

    [mysqldump]
    quick
    max_allowed_packet = 2G
    default-character-set = {{.DefaultCharacterSet}}

    [mysql]
    no-auto-rehash
    show-warnings
    prompt="\u@\h : \d \R:\m:\s> "
    default-character-set = {{.DefaultCharacterSet}}

    [myisamchk]
    key_buffer = 512M
    sort_buffer_size = 512M
    read_buffer = 8M
    write_buffer = 8M

    [mysqlhotcopy]
    interactive-timeout

    [mysqld_safe]
    user=mysql
    open-files-limit = 65535

    [mysqld]
    large-pages
    #***********************************common parameters******************************
    read_only=on
    #memlock
    default-storage-engine = INNODB
    character-set-server={{.DefaultCharacterSet}}
    collation_server = {{.DefaultCharacterSet}}_bin

    user=mysql
    port=3306
    socket=/var/lib/mysql/mysql.sock
    pid-file=/var/lib/mysql/mysql.pid
    datadir=/var/lib/mysql
    tmpdir=/var/lib/mysql

    skip-name-resolve
    skip_external_locking

    lower_case_table_names=1
    event_scheduler=0
    back_log=512
    default-time-zone={{.Timezone}}

    max_connections = {{.MaxConnections}}
    max_connect_errors=99999
    max_allowed_packet = 64M
    slave_pending_jobs_size_max=128M
    max_heap_table_size = 8M
    max_length_for_sort_data = 16k

    wait_timeout=172800
    interactive_timeout=172800

    net_buffer_length = 8K
    read_buffer_size = 2M
    read_rnd_buffer_size = 2M
    sort_buffer_size = 2M
    join_buffer_size = 4M
    binlog_cache_size = 2M

    table_open_cache = 4096
    table_open_cache_instances = 2
    table_definition_cache = 4096
    thread_cache_size = 512
    tmp_table_size = 8M

    query_cache_size=0
    query_cache_type=OFF
    explicit_defaults_for_timestamp=ON

    #*******************************  Logs related settings ***************************
    log-error=/var/log/mysql/error.log
    long_query_time = 1
    slow_query_log = 1
    slow_query_log_file=/var/log/mysql/slow-query.log
    log_slow_slave_statements
    #log_queries_not_using_indexes

    #*******************************  Replication related settings **********************

    #### For Master
    #server-id=3306112
    log-bin=/var/lib/mysql/mysql-bin
    binlog-format=ROW
    binlog-checksum=CRC32
    binlog-rows-query-log-events=1
    max_binlog_size = 512M
    expire_logs_days=15
    sync_binlog=1
    master-verify-checksum=1
    master-info-repository=TABLE
    auto_increment_increment=1
    auto_increment_offset=1

    #### For Slave
    relay-log=/var/lib/mysql/mysql-relay-bin
    relay-log-info-repository=TABLE
    relay-log-recovery=1
    #slave-skip-errors=1022,1032,1062,1236
    slave-sql-verify-checksum=1
    log_bin_trust_function_creators=1
    log_slave_updates=1
    slave-net-timeout=10

    #******************************* MyISAM Specific options ****************************
    key_buffer_size = 8M
    bulk_insert_buffer_size = 8M
    myisam_sort_buffer_size = 64M
    myisam_max_sort_file_size = 10G
    myisam_repair_threads = 1
    myisam_recover_options=force

    # ***************************** INNODB Specific options ****************************
    #### Data options
    innodb_data_home_dir = /var/lib/mysql/
    innodb_data_file_path = ibdata1:256M:autoextend
    innodb_file_per_table
    innodb_file_format = barracuda
    innodb_file_format_max = barracuda
    innodb_file_format_check = ON
    innodb_strict_mode = 1
    innodb_flush_method = fsync
    innodb_checksum_algorithm=crc32
    innodb_autoinc_lock_mode=2

    #### Buffer Pool options
    innodb_buffer_pool_size = 4G
    innodb_buffer_pool_instances = 2
    innodb_max_dirty_pages_pct = 75
    innodb_adaptive_flushing = ON
    innodb_flush_neighbors = 0
    innodb_lru_scan_depth = 4096
    #innodb_change_buffering = inserts
    innodb_old_blocks_time = 1000
    innodb_doublewrite = OFF

    #### Redo options
    innodb_log_group_home_dir =/var/lib/mysql/
    innodb_log_buffer_size = 128M
    innodb_log_file_size = 2G
    innodb_log_files_in_group = 2
    innodb_flush_log_at_trx_commit = 1
    innodb_fast_shutdown = 2
    innodb_support_xa = ON

    #### Transaction options
    innodb_thread_concurrency = 64
    innodb_lock_wait_timeout = 120
    innodb_rollback_on_timeout = 1
    transaction_isolation = READ-COMMITTED

    #### IO options
    innodb_read_io_threads = 8
    innodb_write_io_threads = 16
    innodb_io_capacity = 20000
    innodb_use_native_aio = 1

    #### Undo options
    innodb_undo_directory = /var/lib/mysql/
    innodb_undo_tablespaces=16
    innodb_purge_threads = 4
    innodb_purge_batch_size = 512
    innodb_max_purge_lag = 65536

    #### 5.6/5.7 GTID
    gtid-mode=on # GTID only
    enforce-gtid-consistency=true # GTID only

    #### mysql 5.7
    #super_read_only=on
    secure_file_priv=''
    slave_parallel_workers=16
    slave_parallel_type=LOGICAL_CLOCK
    innodb_undo_log_truncate=ON
    log_timestamps=SYSTEM
    slave_preserve_commit_order=ON

    #### mariadb
    #gtid_strict_mode=on
    #gtid_domain_id=125
    #slave_parallel_threads=16

    #### galera
    wsrep_on=on
    wsrep_provider=/usr/lib/galera3/libgalera_smm.so
    wsrep_provider_options="gcache.size=4G"
    #
    wsrep_sst_method=xtrabackup-v2
    wsrep_sst_auth="xtrabackup:xtrabackuppass"
    wsrep_slave_threads=16
    #
    #innodb_support_xa = OFF
    #sync_binlog=0
    #innodb_flush_log_at_trx_commit = 0
    innodb_doublewrite=off
    !includedir /etc/mysql.cnf.d
    !includedir /etc/mysql/mysql.cnf.d
kind: ConfigMap
metadata:
  creationTimestamp: "2022-01-19T13:09:31Z"
  name: mysql-config
  namespace: squids
  resourceVersion: "97497999"
  uid: b21aad6b-0033-4e51-8a95-e34feed90978
